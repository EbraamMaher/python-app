pipeline{

    agent {label 'agent'}
    
    stages{
        stage('Build image'){
            steps{
                        withCredentials([file(credentialsId: 'gcloud', variable: 'gcloud')]){
                            // sh "kubectl config set-context $(kubectl config current-context)"   // --namespace=${namespace}

                            sh """
                              gcloud auth activate-service-account --key-file="-----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC6GN5WKFzsmk5s\ng7TeHd2iQrReH+OyaVD05TI7zNRr+ifxoQqp/S+Ss76gV6xmjeXqJY2ypJDnyoxy\nw3EBzziMBMlK1UMQKtTjBcpeR8ZAsIYP/6W65ZrqEqbxxurCww3CFopbyn+DhCOh\nYDhd63hpcCEs86I1KK67L8jLHCSB42HSfxyH1EPOm1x/RX1sa7UDqXRoKWT+cQuY\nsp5vVS0VSFHjzgAKKuq/O9FCI8a/Z8IS4KCSMwFqQrmOeO2hcnYTlxnoWW/g3lBW\nCSp0qzm6XjLbztN7nqOPN5cSI5/fdAYeFES+EhsEG+uh7o/9bkIuWU2irlW8UpKR\nTkIObKtzAgMBAAECggEABbAK45E6PdT9fp2L4poBExt8zb+lwucrHUEABwncmCw+\nGkl0vPtK/+3UbqwfTccadsyNBx+2eg8buco1YvvFW6otyMa51P2qIgIkTDtfWMzM\nXCLRGuQ3lt3ZElylAizZ98uekO2gdhGM0TrSnjQ7KuXNbcVIeN10ca4lMef7Sajv\nCSliNnhjzzQe3LUNdFeuwiZoxrOgmTvUCAJiZXsAst5HH40RKrfsP1JlbDpVdaYx\nXrJ5Za05GdZM8v2PtMO7xOK81aSy7NPTMB3bBGwgVkueo1N1u5WqtnnSC+yoRK4L\nWsF5oXeChi2CeufrFl37J8Rqi9V1cByQrSVMNmn0gQKBgQDt8szYC2h0bagIhlJ6\nmWQnsLOuTWHIWGbemkk7i13KXstg+p9rVDGhofqyetrO7e5C09OvQoeAQG9vw+U7\nDLaDwZdtYysqNlotQUeTPfoLH+HiHBaVSH8oGCyeM/nZzQSNoWzqqOO81qOQgvOS\ndZq0MPIDvdGOBKAB5dr2jsGvMwKBgQDINxBJXIUUkzAoB0ZSRUXIIyNpLH5W4g4a\nnDOnqysgA25/80EmLx/jWPyFErkYihL+C9HBXSNqygut0/gxlK2QVwvZ+Ka5Anru\n0KD7gfPtwDHPzBrGkMFgm2ZqhaE/9UFT1Nz7Ylv/INATfsklXsqKkjoh26ja8Zgi\nyqOPh5ISwQKBgFTY1DRhdQC3LUjE5No0oiMI/jkz/J8c7qmHqH9kBbCotqrBE2GJ\nJx10jdlgt288Jk6MDBqdhYW09EeNOcshkF9RA7cMupKVyPgEJAqb+fJHjxs6Ws8m\nh7j7TcWn0PraATqjihvu1y459x8LouDhsKV6IoI1CGk0uv2SQc7TPrtDAoGBAMQi\n/TeBBXYUgxaTmdY6upPHqIb96X6f0YVMBGZ7DrI76mI6IVaQz8JeiHKs1tstWFG7\nrm6pGWsiJ7LQdtHLfwRp4dhU+K9BuMB/bVU2B4qfv6x7nLdtU6OaWQh9hGwtjSPc\n4eb6gnk64dxXViHf7Lc3bO+CSrbB+nIK5ZRUEUuBAoGAGB+fqLupII43ZInF51Ch\nD515iDEpg4m5AcfhVGgLh2pTT8rxTwky5tnjSN9NINHznGsz2Pr+unHNWeGKxKYZ\nBbcpDs0jm+otI9B7azcIX4JA9qwGN2GiLVFSHGj2T7Ilj8UK0MDRG+OngTml1vOW\nOtBgQlL1n/3NQhpTXnAP6jw=\n-----END PRIVATE KEY-----\n"
"
                              // gcloud container clusters get-credentials my-gke-cluster --zone asia-east1-a --project omars-project-367822
                              gcloud container clusters get-credentials app-cluster --region europe-west3 --project gproject-368612
                              sh "docker ps"
                              sh "kubectl version"
                              """
          }
            
            
            }
            post {
                success {
                    sh "docker version"
                }
                
                }

        }

    }
}
