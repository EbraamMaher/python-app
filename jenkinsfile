pipeline{

    agent {label 'agent'}
    
    stages{
        stage('Build image'){
            steps{
                        withCredentials([file(credentialsId: 'gcloud', variable: 'gcloud')]){
                            // sh "kubectl config set-context $(kubectl config current-context)"   // --namespace=${namespace}

                            sh """
                              gcloud auth activate-service-account --key-file="$gcloud"
                              // gcloud container clusters get-credentials my-gke-cluster --zone asia-east1-a --project omars-project-367822
                              gcloud container clusters get-credentials app-cluster --region europe-west3 --project gproject-368612
                              sh "docker ps"
                              sh "kubectl version"
                              """
          }
            
            
            }
            post {
                success {
                    sh "docker version"
                }
                
                }

        }

    }
}
